services:
  web:
    image: nginx:alpine
    ports:
      - "20680:80"
    volumes:
      - ./index.html:/usr/share/nginx/html/index.html:ro
      - ./triage.html:/usr/share/nginx/html/triage.html:ro
      - ./outline.html:/usr/share/nginx/html/outline.html:ro
      - ./css:/usr/share/nginx/html/css:ro
      - ./js:/usr/share/nginx/html/js:ro
      - ./papers.json:/usr/share/nginx/html/papers.json:ro
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
    depends_on:
      - api
    restart: unless-stopped

  api:
    build: .
    volumes:
      - .:/app
    environment:
      - PYTHONUNBUFFERED=1
      - ZOTERO_LIBRARY_ID=${ZOTERO_LIBRARY_ID}
      - ZOTERO_API_KEY=${ZOTERO_API_KEY}
      - ZOTERO_LIBRARY_TYPE=${ZOTERO_LIBRARY_TYPE}
      - APP_API_KEY=${APP_API_KEY}
    restart: unless-stopped
